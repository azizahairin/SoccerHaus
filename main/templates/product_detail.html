{% extends 'base.html' %}
{% load static %}

{% block meta %}
<title>{{ product.name }} – SoccerHaus</title>
{% endblock meta %}

{% block content %}
{% include 'navbar.html' %}

<!-- Page BG -->
<div class="min-h-screen w-full bg-[var(--brand-pink)] pt-24 px-4">
  <!-- Lebar diperpendek -->
  <div class="max-w-2xl mx-auto">

    <!-- Back link -->
    <a href="{% url 'main:show_main' %}"
       class="inline-flex items-center text-[#3F5A83] hover:underline font-medium mb-4">
      ← Back to Products
    </a>

    <!-- Card -->
    <article class="bg-[#E8E2D4] rounded-2xl shadow-md overflow-hidden">
      <!-- Top: image -->
      <div class="bg-white">
        <div class="aspect-[16/9] w-full overflow-hidden">
          {% if product.thumbnail %}
            <img src="{{ product.thumbnail }}" alt="{{ product.name }}" class="w-full h-full object-cover">
          {% else %}
            <div class="w-full h-full bg-gray-200 flex items-center justify-center">
              <img src="{% static 'image/no-products.png' %}" alt="No image"
                   class="w-40 h-40 object-contain opacity-70">
            </div>
          {% endif %}
        </div>
      </div>

      <!-- Content -->
      <div class="p-6 sm:p-8">
        <!-- Badges -->
        <div class="flex flex-wrap gap-2 mb-4">
          {% if product.get_category_display %}
            <span class="px-3 py-1 rounded-full text-xs font-semibold text-white"
                  style="background-color:#3F5A83;">
              {{ product.get_category_display }}
            </span>
          {% endif %}

          {% if user.is_authenticated and product.user == user %}
            <!-- Badge Owner (kecil) -->
            <span class="px-2.5 py-1 rounded-full text-[11px] font-semibold bg-green-100 text-green-700 border border-green-300">
              Owner
            </span>
          {% endif %}

          {% if product.is_featured %}
            <span class="px-3 py-1 rounded-full text-xs font-semibold text-[#3F5A83] bg-white border border-[#3F5A83]/20">
              Featured
            </span>
          {% endif %}

          {% if product.created_at %}
            <span class="px-3 py-1 rounded-full text-xs font-medium text-[#3F5A83] bg-white/70">
              {{ product.created_at|date:"M j, Y" }}
            </span>
          {% endif %}
        </div>

        <!-- Title & price -->
        <div class="flex flex-col md:flex-row md:items-baseline md:justify-between gap-2 mb-2">
          <h1 class="text-3xl font-extrabold text-[#1f2937]">{{ product.name }}</h1>
          {% if product.price %}
            <div class="text-lg font-semibold text-[#3F5A83]">
              Rp {{ product.price }}
            </div>
          {% endif %}
        </div>

        <!-- Description -->
        {% if product.description %}
          <div class="mt-4 text-[#374151] leading-relaxed whitespace-pre-line">
            {{ product.description }}
          </div>
        {% endif %}

        <!-- Owner box -->
        <div class="mt-8 border-t border-white/60 pt-6 bg-white/30 rounded-xl p-4">
          <p class="text-sm font-semibold text-[#1f2937]">
            Owner:
            {% if product.user %}
              {{ product.user.username }}
            {% else %}
              Anonymous
            {% endif %}
          </p>
          <p class="text-xs text-[#6b7280]">Product Owner</p>
        </div>

        <!-- Actions (owner only) -->
        {% if user.is_authenticated and product.user == user %}
          <div class="mt-6 flex flex-wrap gap-3">
            <a href="{% url 'main:edit_product' product.id %}"
               class="px-4 py-2 rounded-md text-sm font-medium text-white"
               style="background-color:#E2A7B6;">
              Edit
            </a>

            <form method="post" action="{% url 'main:delete_product' product.id %}">
              {% csrf_token %}
              <button type="submit"
                      onclick="return confirm('Are you sure you want to delete this product?');"
                      class="px-4 py-2 rounded-md text-sm font-medium text-white"
                      style="background-color:#3F5A83;">
                Delete
              </button>
            </form>
          </div>
        {% endif %}
      </div>
    </article>
  </div>
</div>
{% endblock content %}
